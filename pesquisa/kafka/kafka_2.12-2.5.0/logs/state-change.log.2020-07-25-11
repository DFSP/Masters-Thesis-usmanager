[2020-07-25 12:04:40,377] TRACE [Controller id=0 epoch=1] Changed state of replica 1 for partition my-replicated-topic-0 from OnlineReplica to OfflineReplica (state.change.logger)
[2020-07-25 12:04:40,377] TRACE [Controller id=0 epoch=1] Sending become-leader LeaderAndIsr request LeaderAndIsrPartitionState(topicName='my-replicated-topic', partitionIndex=0, controllerEpoch=1, leader=2, leaderEpoch=1, isr=[2, 0], zkVersion=1, replicas=[2, 1, 0], addingReplicas=[], removingReplicas=[], isNew=false) to broker 2 for partition my-replicated-topic-0 (state.change.logger)
[2020-07-25 12:04:40,377] TRACE [Controller id=0 epoch=1] Sending become-follower LeaderAndIsr request LeaderAndIsrPartitionState(topicName='my-replicated-topic', partitionIndex=0, controllerEpoch=1, leader=2, leaderEpoch=1, isr=[2, 0], zkVersion=1, replicas=[2, 1, 0], addingReplicas=[], removingReplicas=[], isNew=false) to broker 0 for partition my-replicated-topic-0 (state.change.logger)
[2020-07-25 12:04:40,378] TRACE [Controller id=0 epoch=1] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='my-replicated-topic', partitionIndex=0, controllerEpoch=1, leader=2, leaderEpoch=1, isr=[2, 0], zkVersion=1, replicas=[2, 1, 0], offlineReplicas=[1]) to brokers Set(0, 2) for partition my-replicated-topic-0 (state.change.logger)
[2020-07-25 12:04:40,379] TRACE [Broker id=0] Received LeaderAndIsr request LeaderAndIsrPartitionState(topicName='my-replicated-topic', partitionIndex=0, controllerEpoch=1, leader=2, leaderEpoch=1, isr=[2, 0], zkVersion=1, replicas=[2, 1, 0], addingReplicas=[], removingReplicas=[], isNew=false) correlation id 9 from controller 0 epoch 1 (state.change.logger)
[2020-07-25 12:04:40,379] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 9 from controller 0 epoch 1 starting the become-follower transition for partition my-replicated-topic-0 with leader 2 (state.change.logger)
[2020-07-25 12:04:40,381] TRACE [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 1 with correlation id 9 for partition my-replicated-topic-0 with leader 2 (state.change.logger)
[2020-07-25 12:04:40,381] TRACE [Broker id=0] Truncated logs and checkpointed recovery boundaries for partition my-replicated-topic-0 as part of become-follower request with correlation id 9 from controller 0 epoch 1 with leader 2 (state.change.logger)
[2020-07-25 12:04:40,381] TRACE [Broker id=0] Started fetcher to new leader as part of become-follower request from controller 0 epoch 1 with correlation id 9 for partition my-replicated-topic-0 with leader BrokerEndPoint(id=2, host=daniel:9094) (state.change.logger)
[2020-07-25 12:04:40,381] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 9 from controller 0 epoch 1 for the become-follower transition for partition my-replicated-topic-0 with leader 2 (state.change.logger)
[2020-07-25 12:04:40,382] TRACE [Controller id=0 epoch=1] Received response {error_code=0,partition_errors=[{topic_name=my-replicated-topic,partition_index=0,error_code=0,_tagged_fields={}}],_tagged_fields={}} for request LEADER_AND_ISR with correlation id 9 sent to broker daniel:9092 (id: 0 rack: null) (state.change.logger)
[2020-07-25 12:04:40,383] TRACE [Broker id=0] Cached leader info UpdateMetadataPartitionState(topicName='my-replicated-topic', partitionIndex=0, controllerEpoch=1, leader=2, leaderEpoch=1, isr=[2, 0], zkVersion=1, replicas=[2, 1, 0], offlineReplicas=[1]) for partition my-replicated-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 10 (state.change.logger)
[2020-07-25 12:04:40,383] TRACE [Controller id=0 epoch=1] Received response {error_code=0,_tagged_fields={}} for request UPDATE_METADATA with correlation id 10 sent to broker daniel:9092 (id: 0 rack: null) (state.change.logger)
[2020-07-25 12:04:40,384] TRACE [Controller id=0 epoch=1] Received response {error_code=0,_tagged_fields={}} for request UPDATE_METADATA with correlation id 11 sent to broker daniel:9092 (id: 0 rack: null) (state.change.logger)
[2020-07-25 12:04:40,389] TRACE [Controller id=0 epoch=1] Received response {error_code=0,partition_errors=[{topic_name=my-replicated-topic,partition_index=0,error_code=0,_tagged_fields={}}],_tagged_fields={}} for request LEADER_AND_ISR with correlation id 3 sent to broker daniel:9094 (id: 2 rack: null) (state.change.logger)
[2020-07-25 12:04:40,390] TRACE [Controller id=0 epoch=1] Received response {error_code=0,_tagged_fields={}} for request UPDATE_METADATA with correlation id 4 sent to broker daniel:9094 (id: 2 rack: null) (state.change.logger)
[2020-07-25 12:04:40,391] TRACE [Controller id=0 epoch=1] Received response {error_code=0,_tagged_fields={}} for request UPDATE_METADATA with correlation id 5 sent to broker daniel:9094 (id: 2 rack: null) (state.change.logger)
[2020-07-25 12:14:40,958] TRACE [Controller id=0 epoch=1] Changed partition connect-test-0 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2020-07-25 12:14:40,960] TRACE [Controller id=0 epoch=1] Changed state of replica 0 for partition connect-test-0 from NonExistentReplica to NewReplica (state.change.logger)
[2020-07-25 12:14:40,972] TRACE [Controller id=0 epoch=1] Changed partition connect-test-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), zkVersion=0) (state.change.logger)
[2020-07-25 12:14:40,972] TRACE [Controller id=0 epoch=1] Sending become-leader LeaderAndIsr request LeaderAndIsrPartitionState(topicName='connect-test', partitionIndex=0, controllerEpoch=1, leader=0, leaderEpoch=0, isr=[0], zkVersion=0, replicas=[0], addingReplicas=[], removingReplicas=[], isNew=true) to broker 0 for partition connect-test-0 (state.change.logger)
[2020-07-25 12:14:40,973] TRACE [Controller id=0 epoch=1] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='connect-test', partitionIndex=0, controllerEpoch=1, leader=0, leaderEpoch=0, isr=[0], zkVersion=0, replicas=[0], offlineReplicas=[]) to brokers Set(0, 2) for partition connect-test-0 (state.change.logger)
[2020-07-25 12:14:40,973] TRACE [Controller id=0 epoch=1] Changed state of replica 0 for partition connect-test-0 from NewReplica to OnlineReplica (state.change.logger)
[2020-07-25 12:14:40,976] TRACE [Broker id=0] Received LeaderAndIsr request LeaderAndIsrPartitionState(topicName='connect-test', partitionIndex=0, controllerEpoch=1, leader=0, leaderEpoch=0, isr=[0], zkVersion=0, replicas=[0], addingReplicas=[], removingReplicas=[], isNew=true) correlation id 12 from controller 0 epoch 1 (state.change.logger)
[2020-07-25 12:14:40,977] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 12 from controller 0 epoch 1 starting the become-leader transition for partition connect-test-0 (state.change.logger)
[2020-07-25 12:14:40,989] TRACE [Controller id=0 epoch=1] Received response {error_code=0,_tagged_fields={}} for request UPDATE_METADATA with correlation id 6 sent to broker daniel:9094 (id: 2 rack: null) (state.change.logger)
[2020-07-25 12:14:41,005] TRACE [Broker id=0] Stopped fetchers as part of become-leader request from controller 0 epoch 1 with correlation id 12 for partition connect-test-0 (last update controller epoch 1) (state.change.logger)
[2020-07-25 12:14:41,005] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 12 from controller 0 epoch 1 for the become-leader transition for partition connect-test-0 (state.change.logger)
[2020-07-25 12:14:41,006] TRACE [Controller id=0 epoch=1] Received response {error_code=0,partition_errors=[{topic_name=connect-test,partition_index=0,error_code=0,_tagged_fields={}}],_tagged_fields={}} for request LEADER_AND_ISR with correlation id 12 sent to broker daniel:9092 (id: 0 rack: null) (state.change.logger)
[2020-07-25 12:14:41,007] TRACE [Broker id=0] Cached leader info UpdateMetadataPartitionState(topicName='connect-test', partitionIndex=0, controllerEpoch=1, leader=0, leaderEpoch=0, isr=[0], zkVersion=0, replicas=[0], offlineReplicas=[]) for partition connect-test-0 in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 13 (state.change.logger)
[2020-07-25 12:14:41,007] TRACE [Controller id=0 epoch=1] Received response {error_code=0,_tagged_fields={}} for request UPDATE_METADATA with correlation id 13 sent to broker daniel:9092 (id: 0 rack: null) (state.change.logger)
[2020-07-25 12:19:02,971] TRACE [Controller id=0 epoch=1] Changed partition my-replicated-topic-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), zkVersion=2) (state.change.logger)
[2020-07-25 12:19:02,971] TRACE [Controller id=0 epoch=1] Sending become-follower LeaderAndIsr request LeaderAndIsrPartitionState(topicName='my-replicated-topic', partitionIndex=0, controllerEpoch=1, leader=0, leaderEpoch=2, isr=[0], zkVersion=2, replicas=[2, 1, 0], addingReplicas=[], removingReplicas=[], isNew=false) to broker 2 for partition my-replicated-topic-0 (state.change.logger)
[2020-07-25 12:19:02,972] TRACE [Controller id=0 epoch=1] Sending become-leader LeaderAndIsr request LeaderAndIsrPartitionState(topicName='my-replicated-topic', partitionIndex=0, controllerEpoch=1, leader=0, leaderEpoch=2, isr=[0], zkVersion=2, replicas=[2, 1, 0], addingReplicas=[], removingReplicas=[], isNew=false) to broker 0 for partition my-replicated-topic-0 (state.change.logger)
[2020-07-25 12:19:02,972] TRACE [Controller id=0 epoch=1] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='my-replicated-topic', partitionIndex=0, controllerEpoch=1, leader=0, leaderEpoch=2, isr=[0], zkVersion=2, replicas=[2, 1, 0], offlineReplicas=[2, 1]) to brokers Set(0, 2) for partition my-replicated-topic-0 (state.change.logger)
[2020-07-25 12:19:02,972] TRACE [Broker id=0] Received LeaderAndIsr request LeaderAndIsrPartitionState(topicName='my-replicated-topic', partitionIndex=0, controllerEpoch=1, leader=0, leaderEpoch=2, isr=[0], zkVersion=2, replicas=[2, 1, 0], addingReplicas=[], removingReplicas=[], isNew=false) correlation id 14 from controller 0 epoch 1 (state.change.logger)
[2020-07-25 12:19:02,972] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 14 from controller 0 epoch 1 starting the become-leader transition for partition my-replicated-topic-0 (state.change.logger)
[2020-07-25 12:19:02,982] TRACE [Broker id=0] Stopped fetchers as part of become-leader request from controller 0 epoch 1 with correlation id 14 for partition my-replicated-topic-0 (last update controller epoch 1) (state.change.logger)
[2020-07-25 12:19:02,982] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 14 from controller 0 epoch 1 for the become-leader transition for partition my-replicated-topic-0 (state.change.logger)
[2020-07-25 12:19:02,987] TRACE [Controller id=0 epoch=1] Received response {error_code=0,partition_errors=[{topic_name=my-replicated-topic,partition_index=0,error_code=0,_tagged_fields={}}],_tagged_fields={}} for request LEADER_AND_ISR with correlation id 7 sent to broker daniel:9094 (id: 2 rack: null) (state.change.logger)
[2020-07-25 12:19:02,988] TRACE [Controller id=0 epoch=1] Received response {error_code=0,_tagged_fields={}} for request UPDATE_METADATA with correlation id 8 sent to broker daniel:9094 (id: 2 rack: null) (state.change.logger)
[2020-07-25 12:19:02,995] TRACE [Controller id=0 epoch=1] Received response {error_code=0,partition_errors=[{topic_name=my-replicated-topic,partition_index=0,error_code=0,_tagged_fields={}}],_tagged_fields={}} for request LEADER_AND_ISR with correlation id 14 sent to broker daniel:9092 (id: 0 rack: null) (state.change.logger)
[2020-07-25 12:19:02,996] TRACE [Broker id=0] Cached leader info UpdateMetadataPartitionState(topicName='my-replicated-topic', partitionIndex=0, controllerEpoch=1, leader=0, leaderEpoch=2, isr=[0], zkVersion=2, replicas=[2, 1, 0], offlineReplicas=[2, 1]) for partition my-replicated-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 15 (state.change.logger)
[2020-07-25 12:19:02,996] TRACE [Controller id=0 epoch=1] Received response {error_code=0,_tagged_fields={}} for request UPDATE_METADATA with correlation id 15 sent to broker daniel:9092 (id: 0 rack: null) (state.change.logger)
[2020-07-25 12:19:03,854] TRACE [Controller id=0 epoch=1] Changed state of replica 2 for partition my-replicated-topic-0 from OnlineReplica to OfflineReplica (state.change.logger)
[2020-07-25 12:19:03,854] TRACE [Controller id=0 epoch=1] Sending become-leader LeaderAndIsr request LeaderAndIsrPartitionState(topicName='my-replicated-topic', partitionIndex=0, controllerEpoch=1, leader=0, leaderEpoch=2, isr=[0], zkVersion=2, replicas=[2, 1, 0], addingReplicas=[], removingReplicas=[], isNew=false) to broker 0 for partition my-replicated-topic-0 (state.change.logger)
[2020-07-25 12:19:03,854] TRACE [Controller id=0 epoch=1] Sending UpdateMetadata request UpdateMetadataPartitionState(topicName='my-replicated-topic', partitionIndex=0, controllerEpoch=1, leader=0, leaderEpoch=2, isr=[0], zkVersion=2, replicas=[2, 1, 0], offlineReplicas=[2, 1]) to brokers Set(0) for partition my-replicated-topic-0 (state.change.logger)
[2020-07-25 12:19:03,854] TRACE [Broker id=0] Received LeaderAndIsr request LeaderAndIsrPartitionState(topicName='my-replicated-topic', partitionIndex=0, controllerEpoch=1, leader=0, leaderEpoch=2, isr=[0], zkVersion=2, replicas=[2, 1, 0], addingReplicas=[], removingReplicas=[], isNew=false) correlation id 16 from controller 0 epoch 1 (state.change.logger)
[2020-07-25 12:19:03,856] DEBUG [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 16 epoch 1 for partition my-replicated-topic-0 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2020-07-25 12:19:03,857] TRACE [Controller id=0 epoch=1] Received response {error_code=0,partition_errors=[{topic_name=my-replicated-topic,partition_index=0,error_code=11,_tagged_fields={}}],_tagged_fields={}} for request LEADER_AND_ISR with correlation id 16 sent to broker daniel:9092 (id: 0 rack: null) (state.change.logger)
[2020-07-25 12:19:03,857] TRACE [Broker id=0] Cached leader info UpdateMetadataPartitionState(topicName='my-replicated-topic', partitionIndex=0, controllerEpoch=1, leader=0, leaderEpoch=2, isr=[0], zkVersion=2, replicas=[2, 1, 0], offlineReplicas=[2, 1]) for partition my-replicated-topic-0 in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 17 (state.change.logger)
[2020-07-25 12:19:03,858] TRACE [Controller id=0 epoch=1] Received response {error_code=0,_tagged_fields={}} for request UPDATE_METADATA with correlation id 17 sent to broker daniel:9092 (id: 0 rack: null) (state.change.logger)
[2020-07-25 12:19:03,858] TRACE [Controller id=0 epoch=1] Received response {error_code=0,_tagged_fields={}} for request UPDATE_METADATA with correlation id 18 sent to broker daniel:9092 (id: 0 rack: null) (state.change.logger)
[2020-07-25 12:19:05,295] ERROR [Controller id=0 epoch=1] Controller 0 epoch 1 failed to change state for partition my-replicated-topic-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition my-replicated-topic-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:427)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:424)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1141)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1103)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1103)
	at kafka.controller.KafkaController.process(KafkaController.scala:1826)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:128)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:131)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-07-25 12:45:52,238] ERROR [Controller id=0 epoch=1] Controller 0 epoch 1 failed to change state for partition my-replicated-topic-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition my-replicated-topic-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:427)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:424)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1141)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1103)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1103)
	at kafka.controller.KafkaController.process(KafkaController.scala:1826)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:128)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:131)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-07-25 12:45:57,246] ERROR [Controller id=0 epoch=1] Controller 0 epoch 1 failed to change state for partition my-replicated-topic-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition my-replicated-topic-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:427)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:424)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1141)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1103)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1103)
	at kafka.controller.KafkaController.process(KafkaController.scala:1826)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:128)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:131)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:131)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
